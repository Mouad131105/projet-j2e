<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <link rel="stylesheet" href="/webjars/bootstrap/5.1.2/css/bootstrap.min.css" />
    </head>

    <h1>UGEOverflow</h1>
    <h3 th:text="${'Welcome to your home page ' + loggedUser.getUsername()}"></h3>


    <div>
        <button type=button id="button1">Questions</button>
        <button type=button id="button2">Users</button>
        <button type=button id="button3">Tags</button>


        <div id="blocs">

            <div id="bloc1">
                <p>Rechercher une question</p>
            </div>


            <div class="d-none" id="bloc2">
                <!-- <form th:action="@{/registration/profile}" method="post">
                    <div>
                        <input type="text" autocomplete="off" id="selectedUsername" th:name="username" list= "users">
                        <datalist id="users">
                            <option selected disabled hidden style='display: none' value=''></option>
                            <option th:each="user : ${allUsers}" th:value="${user.getUsername()}" th:text="${user.getUsername()}">
                            </option>
                        </datalist>

                        <input type="hidden" id="loggedUsername" name="loggedUser" th:value="${loggedUser.username}">
                        <button id="showProfileButton" type="submit">submit</button>
                    </div>
                </form> -->

                <form th:action="@{/profile/{selectedUsername}(selectedUsername=${selectedUsername})}" method="get">
                    <div>
                        <input type="text" autocomplete="off" name="selectedUsername" list="users">
                        <datalist id="users">
                            <option selected disabled hidden style='display: none' value=''></option>
                            <option th:each="user : ${allUsers}" th:value="${user.getUsername()}" th:text="${user.getUsername()}"></option>
                        </datalist>

                        <input type="hidden" id="loggedUsername" name="loggedUser" th:value="${loggedUser.username}">
                        <button id="showProfileButton" type="submit">submit</button>
                    </div>
                </form>

            </div>


            <div class="d-none" id="bloc3">
                <p>Rechercher un tag</p>
            </div>

        </div>
    </div>

    <script>
        const button1 = document.querySelector("#button1");
        const button2 = document.querySelector("#button2");
        const button3 = document.querySelector("#button3");
        const bloc1 = document.querySelector("#bloc1");
        const bloc2 = document.querySelector("#bloc2");
        const bloc3 = document.querySelector("#bloc3");

        button1.addEventListener("click", () => {
            bloc1.classList.remove("d-none");
            bloc2.classList.add("d-none");
            bloc3.classList.add("d-none");
        });

        button2.addEventListener("click", () => {
            bloc1.classList.add("d-none");
            bloc2.classList.remove("d-none");
            bloc3.classList.add("d-none");
        });

        button3.addEventListener("click", () => {
            bloc1.classList.add("d-none");
            bloc2.classList.add("d-none");
            bloc3.classList.remove("d-none");
        });

        $('showProfileButton').addEventListener("click", () => {
            $.ajax({
                type:"post",
                url: "registration/profile/" + $('#selectedUsername')
            });

            /*const r = new XMLHttpRequest();
            r.open("POST", 'registration/profile/' + $('#selectedUsername'), true);
            r.onreadystatechange = function () {
                if (r.readyState !== 4 || r.status !== 200){
                    return;
                }
                console.log(r.responseText); };
            r.send();*/
        });

    </script>

    <div> <!-- Poser une nouvelle question -->
        <form th:action="@{/question/create}" method="get">
            <input type="hidden" th:name="username" th:value="${loggedUser.username}" />
            <input type="submit" value="New Question"/>
        </form>
    </div>


    <!--  Exemple de select
    <div>
        <select th:field="*{allUsers}">
            <option selected disabled hidden style='display: none' value=''></option>
            <option th:each="user : ${allUsers}" th:value="${user}" th:text="${user.getUsername()}">
            </option>
        </select>

        <button type="submit">submit</button>
    </div>
    -->

</html>